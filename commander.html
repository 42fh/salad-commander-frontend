<h1 style="font-family: Helvetica, sans-serif;">web socket demo</h1>

<body style="padding: 2cm; ">
    <div id="myDiv" style="height: 500px; width: 500px; outline-style: dotted;">
        <p id="wand" style="font-size: 48pt; position: relative; 
            top: 400px; left: 400px;" >ðŸª„</p>
    </div>
</body>

<script>
    var array = [0.8, 0.8];
    var socket_open = false;
    let div = document.getElementById("myDiv");

    echosocket = new WebSocket("wss://salad-commander.onrender.com");

    echosocket.onopen    = (() => socket_open = true);
    echosocket.onmessage = (msg => {
        array = JSON.parse(msg.data);
        var img = document.getElementById("wand");
        img.style.top  = 500 * array[0];
        img.style.left = 500 * array[1];
    });    

    function mouseEvent(ev){
        let x = Math.min(1, Math.max(0, (ev.clientX - div.getBoundingClientRect().left) / 500 ))
        let y = Math.min(1, Math.max(0, (ev.clientY - div.getBoundingClientRect().top)  / 500 ))

        if (socket_open) {echosocket.send((x) + "," + (y))}
    }
    div.onmousemove = mouseEvent;

</script>